<modal [width]="75" [height]="85" (onClose)="_close()">
    <h2>Crear Producto</h2>
    <div class="base-form">
        <div class="image-section">
            <div class="image" (click)="fileInput.click()">
                <input type="file" #fileInput hidden (change)="_onFileSelected($event)" accept="image/*">
                @if (_imageSelected()) {
                <img [src]="_imagePreviewURL()" alt="Imagen del Producto">
                <svg class="change-image" xmlns="http://www.w3.org/2000/svg" width="2rem" height="2rem"
                    viewBox="0 0 24 24">
                    <path fill="currentColor"
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2m.91 16.15a.5.5 0 0 1-.85-.35V17H12c-1.28 0-2.56-.49-3.54-1.46a5 5 0 0 1-1.14-5.3c.19-.51.86-.64 1.24-.25c.22.22.27.54.17.82c-.46 1.24-.2 2.68.8 3.68c.7.7 1.62 1.03 2.54 1.01v-.94c0-.45.54-.67.85-.35l1.62 1.62c.2.2.2.51 0 .71zm2.53-4.13a.78.78 0 0 1-.17-.82c.46-1.24.2-2.68-.8-3.68c-.7-.7-1.62-1.04-2.53-1.02v.94c0 .45-.54.67-.85.35L9.46 8.18c-.2-.2-.2-.51 0-.71l1.62-1.62a.5.5 0 0 1 .85.35v.81c1.3-.02 2.61.45 3.6 1.45a5 5 0 0 1 1.14 5.3c-.19.52-.85.65-1.23.26" />
                </svg>
                }
                @else{
                <svg xmlns="http://www.w3.org/2000/svg" width="3rem" height="3rem" viewBox="0 0 24 24">
                    <path fill="currentColor"
                        d="M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3zm-4.7 6H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v8.3c-.6-.2-1.3-.3-2-.3c-1.1 0-2.2.3-3.1.9L14.5 12L11 16.5l-2.5-3L5 18h8.1c-.1.3-.1.7-.1 1c0 .7.1 1.4.3 2" />
                </svg>

                <p>Subir Imagen *</p>
                }
            </div>
        </div>
        <div class="form-section">
            <form [formGroup]="_createProductForm">
                <h3>Información del Producto</h3>
                <p>Los campos con un (*) son obligatorios</p>
                <input-form formControlName="name" label="Nombre" name="Nombre" [requiredMark]="true"
                    placeholder="Ingrese el nombre" [maxLength]="200"
                    RegexErrorMessage="Solo letras y números, sin espacios al inicio o final ni espacios dobles." />
                <div class="description">
                    <label for="description">Descripción *</label>
                    <textarea formControlName="description" name="description" rows="4" [maxLength]="_maxLenght"
                        placeholder="Ingrese la descripción"></textarea>
                    <div class="labels">
                        @if (description?.invalid && description?.touched) {
                        @if (description?.errors) {
                        @if (description?.hasError('required')) {
                        <small class="error">La descripción es obligatoria.</small>
                        }
                        @else if (description?.hasError('minlength')) {
                        <small class="error">Mínimo 10 caracteres.</small>
                        }
                        }
                        }
                        @else{
                        <div></div>
                        }
                        <small>{{description?.value.length}}/{{_maxLenght}}</small>
                    </div>
                </div>
                <div class="double-input">
                    <input-form formControlName="price" label="Precio ($)" name="Precio" type="number"
                        [requiredMark]="true" placeholder="100.00" />
                    <input-form formControlName="content" label="Contenido" name="Contenido" type="number"
                        [requiredMark]="true" placeholder="100" />
                    <select-units-forms formControlName="unit" />
                    <select-raw-materials-form formControlName="rawMaterial" />
                </div>
                <hr>
                <h4>Datos de Producción</h4>
                <div class="double-input">
                    <input-form formControlName="stockMin" label="Stock Mínimo" name="Stock Mínimo" type="number"
                        [requiredMark]="true" placeholder="10" />
                    <input-form formControlName="rawMaterialNeeded" label="Materia Prima Necesaria por Pieza (Kg)"
                        name="Materia Prima Necesaria" type="number" [requiredMark]="true" placeholder="0.5" />
                    <input-form formControlName="timeNeeded" label="Tiempo Necesario por Pieza (Min)"
                        name="Tiempo Necesario" [requiredMark]="true" type="number" placeholder="20" />
                </div>
            </form>
            <loading-button [disabled]="_createProductForm.invalid || !_imageSelected()" label="Añadir Producto"
                [isLoading]="_isLoading()" (onClick)="_createProduct()"/>
        </div>
    </div>

</modal>
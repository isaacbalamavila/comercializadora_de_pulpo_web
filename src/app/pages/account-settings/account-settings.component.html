<div class="container">
    <header>
        <h1>Mi Perfil</h1>
    </header>
    <div class="main-container">

        @if (!isLoading && !error) {
        <div class="user-info-container">
            <user-avatar-square [label]="userLabel" />
            <span class="name">{{user?.name}} {{user?.lastName}}</span>
            <div class="user-info">
                <div class="icon-info">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1.25rem" height="1.25rem" viewBox="0 0 24 24">
                        <path fill="currentColor"
                            d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25a.85.85 0 1 1 .9-1.44L12 11l6.7-4.19a.85.85 0 1 1 .9 1.44" />
                    </svg>
                    <span>{{user?.email}}</span>
                </div>
                <div class="icon-info">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1.25rem" height="1.25rem" viewBox="0 0 24 24">
                        <path fill="currentColor"
                            d="M6.62 10.79c1.44 2.83 3.76 5.15 6.59 6.59l2.2-2.2c.28-.28.67-.36 1.02-.25c1.12.37 2.32.57 3.57.57a1 1 0 0 1 1 1V20a1 1 0 0 1-1 1A17 17 0 0 1 3 4a1 1 0 0 1 1-1h3.5a1 1 0 0 1 1 1c0 1.25.2 2.45.57 3.57c.11.35.03.74-.25 1.02z" />
                    </svg>
                    <span>{{user?.phone ? user?.phone : 'No Agregado.'}}
                    </span>
                </div>
                <div class="icon-info">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1.25rem" height="1.25rem" viewBox="0 0 24 24">
                        <path fill="currentColor"
                            d="M15 21h-2a2 2 0 0 1 0-4h2v-2h-2a4 4 0 0 0 0 8h2Zm8-2a4 4 0 0 1-4 4h-2v-2h2a2 2 0 0 0 0-4h-2v-2h2a4 4 0 0 1 4 4" />
                        <path fill="currentColor"
                            d="M14 18h4v2h-4zm-7 1a6 6 0 0 1 .09-1H3v-1.4c0-2 4-3.1 6-3.1a8.6 8.6 0 0 1 1.35.125A5.95 5.95 0 0 1 13 13h5V4a2.006 2.006 0 0 0-2-2h-4.18a2.988 2.988 0 0 0-5.64 0H2a2.006 2.006 0 0 0-2 2v14a2.006 2.006 0 0 0 2 2h5.09A6 6 0 0 1 7 19M9 2a1 1 0 1 1-1 1a1.003 1.003 0 0 1 1-1m0 4a3 3 0 1 1-3 3a2.996 2.996 0 0 1 3-3" />
                    </svg>
                    <span style="text-transform: capitalize;">{{user?.role}}</span>
                </div>
                <div class="icon-info">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1.25rem" height="1.25rem" viewBox="0 0 24 24">
                        <g fill="none">
                            <path fill="currentColor"
                                d="M2 9c0-1.886 0-2.828.586-3.414S4.114 5 6 5h12c1.886 0 2.828 0 3.414.586S22 7.114 22 9c0 .471 0 .707-.146.854C21.707 10 21.47 10 21 10H3c-.471 0-.707 0-.854-.146C2 9.707 2 9.47 2 9m0 9c0 1.886 0 2.828.586 3.414S4.114 22 6 22h12c1.886 0 2.828 0 3.414-.586S22 19.886 22 18v-5c0-.471 0-.707-.146-.854C21.707 12 21.47 12 21 12H3c-.471 0-.707 0-.854.146C2 12.293 2 12.53 2 13z" />
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7 3v3m10-3v3" />
                        </g>
                    </svg>
                    <span>{{user?.createdAt |date: 'dd/MM/yyyy'}}</span>
                </div>
            </div>
        </div>
        <div class="change-password-form">
            <form #form="ngForm" (ngSubmit)="changePassword()">
                <h2>Cambiar Contraseña</h2>
                <password-input name="newPassword" label="Ingrese la nueva contraseña *" [(ngModel)]="newPassword"
                    (ngModelChange)="verifyPasswords()" [required]="false" />
                <password-input name="newPasswordConfirmation" label="Confirme la nueva contraseña *"
                    [(ngModel)]="newPasswordConfirmation" (ngModelChange)="verifyPasswords()" [required]="false" />
                <div class="validations">
                    <validation-text [isValid]="equalPasswords" message="Las contraseñas coinciden." />
                    <validation-text [isValid]="passwordMininumLeght"
                        message="La contraseña tiene al menos 8 caracteres." />
                    <validation-text [isValid]="passwordHasSpecialCharacters" [message]="specialCharacterMessage" />
                    <validation-text [isValid]="passwordHasMayus" message="La contraseña tiene una mayúscula." />
                </div>
                <button type="submit" [disabled]="!isValidPassword() || requestLoading">
                    @if (requestLoading) {
                    <small-loader />
                    } @else {
                    Actualizar Contraseña
                    }
                </button>
            </form>
        </div>

        }
        @if (isLoading && !error) {
        <page-loader />
        }

        @if (error) {
        <page-error [statusCode]="error.statusCode" />
        }
    </div>
</div>